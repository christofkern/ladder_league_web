<!DOCTYPE html>
<html>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
<link rel="stylesheet" href="{{ url_for('static', filename='styles_intro.css') }}">


<body class="intro" width=1920px height=1080px>
    <div id="info_container" class="container raceversus invisible">
        <div class="row">
        <p id="racename" class="racetitle text-center align-self-center"> </p>
        </div>
        <div class="row">
        <p id="name1" class="text-center align-self-center raceparticipants"></p>
        </div>
        <div class="row">
        <p class="text-center align-self-center raceparticipants">&nbsp;&nbsp;vs.</p>
        </div>
        <div class="row">
        <p id="name2" class="text-center align-self-center raceparticipants"></p>
        </div>
        <div class="row">
        <p id="vs2" class="text-center align-self-center raceparticipants">&nbsp;&nbsp;vs.</p>
        </div>
        <div class="row 3ponly">
        <p  id="name3" class="text-center align-self-center raceparticipants"></p>
        </div>
    </div>
</body>


<script>

    let s_id = "{{spreadsheet_id}}";

    function setTitleAndRunners(){
        console.log(s_id)
        fetch('/static_info?spreadsheet_id=' + encodeURIComponent(s_id))
            .then(response => response.json())
                .then(data => {      
                    //check if there is an entry error, if not extract the entries 'racename', 'runners', 'country_urls'. The both last are arrys in python
                    if (data.error) {
                        console.error("Error in data:", data.error);
                    } else {
                        const racename = data[0].racename;
                        const runners = data[1].runners;
                        const country_urls = data[2].country_urls;

                        document.getElementById("racename").innerHTML = racename

                        for (var i = 0; i < Math.min(3, runners.length); i++) {
                            var fieldName = 'name' + (i + 1);
                            document.getElementById(fieldName).innerHTML = runners[i] + '&nbsp<img src="' + country_urls[i] + '" style="width: 64px; margin-top:-11px">'
                        }

                        
                        if (runners.length < 3){
                            //make third runner invisible
                            document.getElementById("name3").classList.add("invisible");
                            document.getElementById("vs2").classList.add("invisible");
                        
                            //center text
                            var inner = document.getElementById("info_container").innerHTML;
                            document.getElementById("info_container").innerHTML = '<div class="row"><p class="text-center align-self-center raceparticipants">&nbsp;&nbsp;</p></div>' + inner;
                        }
                                               
                        


                        document.getElementById("info_container").classList.remove('invisible') 

                    }
                })
        .catch(error => {
            console.error("Error fetching static info", error);
        });
    }

    setTitleAndRunners();
</script>

</html>